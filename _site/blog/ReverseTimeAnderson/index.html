<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
  Jekyll integration by somiibo.com
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
--><html>
	<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<title>Reverse Time Stochastic Differential Equations</title>
<meta name="description" content="">

<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/icon/favicon-16x16.png">
<link rel="manifest" href="http://localhost:4000/assets/icon/manifest.json">
<link rel="mask-icon" href="http://localhost:4000/assets/icon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="http://localhost:4000/assets/icon/favicon.ico">
<meta name="msapplication-config" content="http://localhost:4000/assets/icon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- CSS -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<noscript><link rel="stylesheet" href="http://localhost:4000/assets/css/noscript.css"></noscript>

	</head>
	<body class="is-loading">

		<!-- Wrapper -->
			<div id="wrapper" class="fade-in">

				<!-- Header -->
        <header id="header">
          <a href="http://localhost:4000/" class="logo">Ludwig Winkler</a>
        </header>

				<!-- Nav -->
					<nav id="nav">

            <ul class="links">
  <li class=""><a href="http://localhost:4000/">Home</a></li>
  <li class=" active "><a href="http://localhost:4000/blog/">Blog</a></li>
  <li class=""><a href="http://localhost:4000/readinglist/">Reading List</a></li>
  <li class=""><a href="http://localhost:4000/photography/">Photography</a></li>
  <li class=""><a href="http://localhost:4000/about/">About</a></li>
</ul>


						<ul class="icons">
              <li><a href="https://twitter.com/default" class="icon fa-twitter" rel="nofollow"><span class="label">Twitter</span></a></li>
              <!-- <li><a href="https://facebook.com/default" class="icon fa-facebook" rel="nofollow"><span class="label">Facebook</span></a></li> -->
              <!-- <li><a href="https://instagram.com/default" class="icon fa-instagram" rel="nofollow"><span class="label">Instagram</span></a></li> -->
              <li><a href="https://github.com/default" class="icon fa-github" rel="nofollow"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
				<div id="main">
          <section class="post">
    				<header class="major">
      				<span class="date">09 Apr 2021</span>
      				<h1>Reverse Time Stochastic Differential Equations</h1>
      				<p> 'If I Could Turn Back Time' by Cher (1989)</p>
      			</header>
      			<div class="image main"><img src="" alt=""></div>
      			<p></p>
<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
       <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             displayMath: [['$$','$$']],
             processEscapes: true
           },
		   TeX: {extensions:["autoload-all.js"]}
         });
       </script>
       <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>


<p>What follows is a derivation of the main result of ‘Reverse-Time Diffusion Equation Models’ by Brian D.O. Anderson (1982).
Earlier we learned that for a stochastic differential equation of the form
<script type="math/tex">\begin{align}
	dX_t = \mu(X_t, t) dt + \sigma(X_t, t) dW_t
\end{align}</script>
with the derivative of Wiener process $W_t$ admits to types of equations, called the forward Kolmogorov or Fokker-Planck equation and the backward Kolmogorov equation.
For notational brevity we will use the term $\mu(x_t)$ for the drift and $\sigma(x_t)$ as the diffusion parameter and omit the explicit time dependency.</p>

<p>The Kolmogorov forward equation is identical to the Fokker Planck equation and states
<script type="math/tex">\begin{align}
	\partial_t p(x_t) = -\partial_{x_t} \left[ f(x_t) p(x_t) \right] + \frac{1}{2} \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right].
\end{align}</script></p>

<p>It describes the evolution of a probability distribution $p(x_t)$ forward in time.
We can quite frankly think of it as, for example, a Normal distribution being slowly transformed into an arbitrary complex distribution according to the drift and diffusion parameters.</p>

<p>The Kolmogorov backward equation for $t \leq s$ is defined as
<script type="math/tex">\begin{align}
	- \partial_t p(x_s | x_t) = f(x_t) \ \partial_{x_t} p(x_s|x_t) + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t)
\end{align}</script>
and it basically answers the question how the probability of $x_s$ at a later point in time changes as we change $x_t$.
The Kolmogorov backward equation is somewhat confounding with respect to time as we’re taking the partial derivative with respect to time to the value $x_t$ on which we are coniditoning.
But we can think of it as asking ‘How does the probability of $x_s$ change, as we slowly evolve the probability distribution backwards through time and condition on $x_t$’.</p>

<p>The backward equation gives us a partial differential equation which we can solve backward in time, which would correspond to evolving the arbitrarily complex distribution backwards to our original Normal distribution. 
Unfortunately there is no corresponding stochastic differential equation with a drift and diffusion term that describes the evolution of a random variable backwards through time.
This is where the remarkable result from Anderson (1982) comes into play.</p>

<p>Bayes theorem tells us that $p(x_s , x_t) = p(x_s|x_t) p(x_t)$ and we can ask ourselves what the partial differential equation would be that describes the evolution of the joint distribution over time.
First multiplying both sides of Bayes theorem with minus one and taking the derivative with respect to time $t$, we obtain via the product rule
<script type="math/tex">% <![CDATA[
\begin{align}
	- \partial_t p(x_s, x_t) &= - \partial_t \left[ p(x_s| x_t) p(x_t) \right] \\
	&= -\partial_t p(x_s|x_t) p(x_t) - p(x_s | x_t) \partial_t p(x_t)
\end{align} %]]></script>
into which we can plug in the Kolmogorov forward and backward equations, 
<script type="math/tex">% <![CDATA[
\begin{align}
	& -\partial_t p(x_s|x_t) p(x_t) - p(x_s | x_t) \partial_t p(x_t) \\
	&= \left( f(x_t) \ \partial_{x_t} p(x_s|x_t) + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \right) p(x_t) \\
	& + p(x_s| x_t) \left( \partial_{x_t} \left[ f(x_t) p(x_t) \right] - \frac{1}{2} \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \right)
\end{align} %]]></script></p>

<p>The derivative occuring in the backward Kolmogorov equation are
The derivatives of the probabilities are the following
<script type="math/tex">% <![CDATA[
\begin{align}
	\partial_{x_t} p(x_s|x_t) &= \partial_{x_t} \left[ \frac{p(x_s, x_t)}{p(x_t)} \right] \\
	& = \frac{\partial_{x_t} p(x_s, x_t) p(x_t) - p(x_s, x_t) \partial_{x_t} p(x_t)}{p^2(x_t)} \\
	& = \frac{\partial_{x_t} p(x_s, x_t)}{p(x_t)} - \frac{p(x_s, x_t) \partial_{x_t} p(x_t)}{p^2(x_t)}
\end{align} %]]></script></p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
	\partial_{x_t}^2 p(x_s|x_t) = & \partial_{x_t}^2 \left[ \frac{p(x_s, x_t)}{p(x_t)} \right] \\
	= & \frac{\partial_{x_t}^2 p(x_s, x_t)}{p(x_t)} 
	- \frac{2 \ \partial_{x_t}p(x_s, x_t) \partial_{x_t}p( x_t)}{p^2( x_t)} \\
	& - \frac{p(x_s, x_t) \partial_{x_t}^2 p(x_t)}{p^2(x_t)}
	+ \frac{2 \ p(x_s, x_t) \left(\partial_{x_t} p(x_t)\right)^2}{p^3(x_t)}
\end{align} %]]></script>

<p>The next step is to evaluate the derivative of the products in the forward Kolmogorov equation.
<script type="math/tex">% <![CDATA[
\begin{align}
	\partial_{x_t} \left[ f(x_t) p(x_t) \right] & = \partial_{x_t} f(x_t) \ p(x_t) + f(x_t) \ \partial_{x_t} p(x_t) \\
	\partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] & = \partial_{x_t}^2 g(x_t) g(x_t) \ p(x_t) + 2 \ \partial_{x_t} g(x_t) g(x_t) \ \partial_{x_t} p(x_t) + g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_t)
\end{align} %]]></script></p>

<p>Plugging in the derivatives of the probability distributions we obtain
<script type="math/tex">% <![CDATA[
\begin{align}
	- \partial_t p(x_s, x_t)
	= & - \partial_t \left[ p(x_s| x_t) p(x_t) \right] \\
	= & -\partial_t p(x_s|x_t) p(x_t) - p(x_s | x_t) \partial_t p(x_t) \\
	= & \left( f(x_t) \ \partial_{x_t} p(x_s|x_t) + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \right) p(x_t) \\
	& + p(x_s| x_t) \left( \partial_{x_t} \left[ f(x_t) p(x_t) \right] - \frac{1}{2} \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \right) \\
	= & f(x_t) \ \partial_{x_t} p(x_s|x_t) \ p(x_t) \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) \\
	& + p(x_s| x_t) \partial_{x_t} f(x_t) \ p(x_t) + p(x_s| x_t) f(x_t) \ \partial_{x_t} p(x_t) \\
	& - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & f(x_t) \ \left(\frac{\partial_{x_t} p(x_s, x_t)}{p(x_t)} - \frac{p(x_s, x_t) \partial_{x_t} p(x_t)}{p^2(x_t)} \right) \ p(x_t) \\
	& + p(x_s| x_t) \partial_{x_t} f(x_t) \ p(x_t) + p(x_s| x_t) f(x_t) \ \partial_{x_t} p(x_t) \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & f(x_t) \ \left(\partial_{x_t} p(x_s, x_t) - \frac{p(x_s, x_t) \partial_{x_t} p(x_t)}{p(x_t)} \right) \\
	& + p(x_s| x_t) \partial_{x_t} f(x_t) \ p(x_t) + p(x_s| x_t) f(x_t) \ \partial_{x_t} p(x_t) \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & f(x_t) \ \left(\partial_{x_t} p(x_s, x_t) - \cancel{p(x_s| x_t) \partial_{x_t} p(x_t)} \right) \\
	& + p(x_s, x_t) \partial_{x_t} f(x_t) + \cancel{p(x_s| x_t) f(x_t) \ \partial_{x_t} p(x_t)} \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & f(x_t) \ \partial_{x_t} p(x_s, x_t) + p(x_s, x_t) \partial_{x_t} f(x_t) \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right]
\end{align} %]]></script></p>

<p>We can see now that the drift term already fulfills the requirements of the forward Kolmogorov equation.
What we’re left with and which we have to take care of are the two terms with the diffusion terms.
The goal is to fuse the two terms into one which resembles the diffusion term in the forward Kolmogorov equation.</p>

<p>Following the gracious help from Anderson himself in an email from down under, we can simplify the terms with $g(x_t) g(x_t)$ by expanding the last term.
The important step is to factorize the joint distribution $p(x_s, x_t) = p(x_s| x_t) p(x_t)$ and invoke the product rule.
<script type="math/tex">% <![CDATA[
\begin{align}
	& \frac{1}{2} \partial_{x_t}^2 \left[ p(x_s, x_t) g(x_t) g(x_t) \right] \\
	= & \frac{1}{2} \partial_{x_t}^2 \left[ p(x_s | x_t) p(x_t) g(x_t) g(x_t) \right] \\
	= & \frac{1}{2} \partial_{x_t}^2 p(x_s | x_t) p(x_t) g(x_t) g(x_t) + \partial_{x_t} \left[ p(x_t) g(x_t) g(x_t) \right] \partial_{x_t} p(x_s| x_t)
	 + \frac{1}{2} \partial_{x_t}^2 \left[ p(x_t) g(x_t) g(x_t) \right] p(x_s| x_t)
\end{align} %]]></script></p>

<p>We can see from the expansion of the derivative above that we can combine the terms in our derivation if we expand the “center term”.
Furthermore we can employ the identity $-\frac{1}{2} X = -X + \frac{1}{2} X$ to obtain
<script type="math/tex">% <![CDATA[
\begin{align}
	-\partial_t p(x_s, x_t)
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) - \underbrace{ \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] }_{-\frac{1}{2} X = -X + \frac{1}{2} X} \\
	& \pm \partial_{x_t} p(x_s | x_t) \partial_{x_t} \left[ p(x_t) g(x_t) g(x_t) \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] \\
	& + \frac{1}{2} \ g(x_t) g(x_t) \ \partial_{x_t}^2 p(x_s | x_t) \ p(x_t) \\
	& \underbrace{ - p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] + \frac{1}{2} p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] }_{-\frac{1}{2} X = -X + \frac{1}{2} X} \\
	& \pm \partial_{x_t} p(x_s | x_t) \partial_{x_t} \left[ p(x_t) g(x_t) g(x_t) \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] + \frac{1}{2} \partial_{x_t}^2 \left[ p( x_s | x_t) p(x_t) g(x_t) g(x_t) \right] \\
	& - p(x_s| x_t) \partial_{x_t}^2 \left[ g(x_t) g(x_t) \ p(x_t) \right] - \partial_{x_t} p(x_s | x_t) \partial_{x_t} \left[ p(x_t) g(x_t) g(x_t) \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) \right] + \frac{1}{2} \partial_{x_t}^2 \left[ p( x_s , x_t) g(x_t) g(x_t) \right] \\
	& - \partial_{x_t} \left[ p(x_s| x_t) \partial_{x_t} \left[ g(x_t) g(x_t) \ p(x_t) \right] \right] \\
	= & \partial_{x_t} \left[ f(x_t) \ p(x_s, x_t) - p(x_s| x_t) \partial_{x_t} \left[ g(x_t) g(x_t) \ p(x_t) \right] \right] \\
	& + \frac{1}{2} \partial_{x_t}^2 \left[ p( x_s , x_t) g(x_t) g(x_t) \right] \\
	= & \partial_{x_t} \left[ p(x_s, x_t) \left( f(x_t) - \frac{1}{p(x_t)} \partial_{x_t} \left[ g(x_t) g(x_t) \ p(x_t) \right] \right) \right] \\
	& + \frac{1}{2} \partial_{x_t}^2 \left[ p( x_s , x_t) g(x_t) g(x_t) \right]
\end{align} %]]></script></p>

      		</section>

          <!-- <div class="comments-wrapper">
          <div id="disqus_thread"></div> -->
          <!-- <script>
              /**
               *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
               *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
               */

              var disqus_config = function () {
                  this.page.url = '/blog/ReverseTimeAnderson/';  /*Replace PAGE_URL with your page's canonical URL variable*/
                  this.page.identifier = '/blog/ReverseTimeAnderson/'; /*Replace PAGE_IDENTIFIER with your page's unique identifier variable*/
              };

              (function() {  /* dont endit below this line */
                  var d = document, s = d.createElement('script');

                  s.src = 'https://default.disqus.com/embed.js';

                  s.setAttribute('data-timestamp', +new Date());
                  (d.head || d.body).appendChild(s);
              })();
          </script> -->
          <!-- <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> -->
        <!-- </div>/.comments-wrapper -->


					<!-- Footer -->
						<footer>
              <ul class="actions">
                <li><a href="http://localhost:4000/blog/" class="button">My Blog</a></li>
              </ul>
						</footer>
					</div>

				<!-- Footer -->
        <!-- <footer id="footer">
  <section>
    <form method="POST" action="https://formspree.io/">
      <div class="field">
        <label for="name">Name</label>
        <input type="text" name="name" id="name" />
      </div>
      <div class="field">
        <label for="email">Email</label>
        <input type="text" name="email" id="email" />
      </div>
      <div class="field">
        <label for="message">Message</label>
        <textarea name="message" id="message" rows="3"></textarea>
      </div>
      <ul class="actions">
        <li><input type="submit" value="Send Message" /></li>
      </ul>
    </form>
  </section>
  <section class="split contact">
    <section class="alt">
      <h3>Location</h3>
      <p>Berlin, Germany</p>
    </section>
    <section>
      <h3>Phone</h3>
      <p><a href="tel:"></a></p>
    </section>
    <section>
      <h3>Email</h3>
      <p><a href="mailto:"></a></p>
    </section>
    <section>
      <h3>Social</h3>
      <ul class="icons alt">
        <li><a href="https://twitter.com/ludiXIVwinkler" class="icon fa-twitter" rel="nofollow"><span class="label">Twitter</span></a></li>
        <!-- <li><a href="https://facebook.com/default" class="icon fa-facebook" rel="nofollow"><span class="label">Facebook</span></a></li> -->
        <!-- <li><a href="https://instagram.com/default" class="icon fa-instagram" rel="nofollow"><span class="label">Instagram</span></a></li> -->
        <li><a href="https://github.com/ludwigwinkler" class="icon fa-github" rel="nofollow"><span class="label">GitHub</span></a></li>
      
    
  

<!-- Copyright -->
<div id="copyright">
  <ul>
       <li>© HTML5 UP</li>
       <li>Design by <a href="https://html5up.net" rel="nofollow">HTML5 UP</a>
</li>
       <li>Jekyll Integration by <a href="https://soundgrail.com">SoundGrail</a>
</li>
       <li>Theme made by <a href="https://github.com/iwiedenm/jekyll-theme-massively-src"> iwiedenm</a>
</li>
 </ul>
</div>
 --&gt;

			</div>

      <!-- Scripts -->
  		<!-- <!-- DYN -->
<script src="http://localhost:4000/assets/js/jquery.min.js"></script>
<script src="http://localhost:4000/assets/js/jquery.scrollex.min.js"></script>
<script src="http://localhost:4000/assets/js/jquery.scrolly.min.js"></script>
<script src="http://localhost:4000/assets/js/skel.min.js"></script>
<script src="http://localhost:4000/assets/js/util.js"></script>
<script src="http://localhost:4000/assets/js/main.js"></script>
 --&gt;
			<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=default"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'default');
</script>
 -->

	</body>
</html>
